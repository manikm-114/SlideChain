Whenever you can, avoid loops — and write in matrix form.
Instead of looping to square elements, just write “A dot caret 2”.
Want row-wise sums? Use “sum of A, comma 2”.
Need probabilities per row? Divide each row by its total using matrix broadcasting — it’s cleaner and faster than nested loops.